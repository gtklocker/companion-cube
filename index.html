<!DOCTYPE html>
<html>
    <head>
        <title>Companion Cube</title>
        <style>
            canvas {
                display: block;
                margin: auto;
            }
        </style>
    </head>
    <body>
        <script src='jquery.min.js'></script>
        <script src='three.min.js'></script>
        <script src='OBJLoader.js'></script>
        <script src='MTLLoader.js'></script>
        <script src='OBJMTLLoader.js'></script>
        <script>
            var W = 600, H = 600;
            var VIEW_ANGLE = 45, ASPECT = W / H, NEAR = 0.1, FAR = 10000;

            var renderer = new THREE.WebGLRenderer({alpha: true});
            var camera = new THREE.PerspectiveCamera(
                VIEW_ANGLE, ASPECT, NEAR, FAR
            );

            var scene = new THREE.Scene();
            scene.add(camera);
            camera.position.z = 300;
            renderer.setSize(W, H);
            $('body').append(renderer.domElement);

            var pointLight = new THREE.PointLight(0xFFFFFF);
            pointLight.position.z = 1000;
            scene.add(pointLight);

            var loader = new THREE.OBJMTLLoader();
            var companionCube;
            loader.load('resources/WeightedCompanionCubeHearted.obj', 'resources/cube.mtl', function(cube) {
                var texture = THREE.ImageUtils.loadTexture('resources/metal_box.jpg', {}, function() {
                    companionCube = cube;

                    for (var i = 0, l = companionCube.children[0].children.length; i < l; ++i) {
                        companionCube.children[0].children[i].material.map = texture;
                    }
                    companionCube.position.z = 290;
                    scene.add(companionCube);
                });
            });

            function render() {
                requestAnimationFrame(render);

                if (companionCube) {
                    companionCube.rotation.x += 0.03;
                    companionCube.rotation.y += 0.03;
                }
                renderer.render(scene, camera);
            }
            render();
        </script>
    </body>
</html>
